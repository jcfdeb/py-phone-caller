<svg width="1600" height="900" viewBox="0 0 1600 900" fill="none" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="bg" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#0b111a" />
      <stop offset="100%" stop-color="#0f1a2a" />
    </linearGradient>
    <linearGradient id="node" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#162235" />
      <stop offset="100%" stop-color="#0e1726" />
    </linearGradient>
    <linearGradient id="nodeTop" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#2a3d55" stop-opacity="0.7" />
      <stop offset="100%" stop-color="#2a3d55" stop-opacity="0" />
    </linearGradient>
    <radialGradient id="glowTeal" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(280 160) scale(260)">
      <stop offset="0%" stop-color="#5cd6c7" stop-opacity="0.22" />
      <stop offset="100%" stop-color="#5cd6c7" stop-opacity="0" />
    </radialGradient>
    <radialGradient id="glowOrange" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(1240 620) scale(300)">
      <stop offset="0%" stop-color="#ff6f3c" stop-opacity="0.18" />
      <stop offset="100%" stop-color="#ff6f3c" stop-opacity="0" />
    </radialGradient>
    <pattern id="dotGrid" width="22" height="22" patternUnits="userSpaceOnUse">
      <circle cx="1" cy="1" r="1" fill="#1f2a3b" opacity="0.55" />
    </pattern>
    <filter id="softShadow" x="-40%" y="-40%" width="180%" height="180%">
      <feDropShadow dx="0" dy="12" stdDeviation="10" flood-color="#05080f" flood-opacity="0.5" />
      <feDropShadow dx="0" dy="0" stdDeviation="6" flood-color="#1b2c3f" flood-opacity="0.5" />
    </filter>
    <marker id="arrowTeal" markerWidth="12" markerHeight="12" refX="9" refY="4.5" orient="auto">
      <path d="M0 0L9 4.5L0 9Z" fill="#5cd6c7" />
    </marker>
    <marker id="arrowOrange" markerWidth="12" markerHeight="12" refX="9" refY="4.5" orient="auto">
      <path d="M0 0L9 4.5L0 9Z" fill="#ff6f3c" />
    </marker>
    <marker id="arrowBlue" markerWidth="12" markerHeight="12" refX="9" refY="4.5" orient="auto">
      <path d="M0 0L9 4.5L0 9Z" fill="#75c8ff" />
    </marker>
    <marker id="arrowYellow" markerWidth="12" markerHeight="12" refX="9" refY="4.5" orient="auto">
      <path d="M0 0L9 4.5L0 9Z" fill="#ffd166" />
    </marker>
    <style>
      text { font-family: "DejaVu Sans", Arial, sans-serif; }
      .group-label { fill: #92a3bd; font-size: 12px; letter-spacing: 1.6px; }
      .node-title { fill: #f2eee5; font-size: 12px; font-weight: 600; }
      .node-sub { fill: #a7b1c4; font-size: 10px; }
      .node { fill: url(#node); stroke: #24364c; stroke-width: 1; filter: url(#softShadow); }
      .node-top { fill: url(#nodeTop); }
      .group-box { fill: #0f1724; fill-opacity: 0.6; stroke: #1e2b3d; stroke-width: 1.2; }
      .flow { stroke: #5cd6c7; stroke-width: 2.2; fill: none; }
      .flow-orange { stroke: #ff6f3c; stroke-width: 2.2; fill: none; }
      .flow-blue { stroke: #75c8ff; stroke-width: 2.2; fill: none; }
      .flow-yellow { stroke: #ffd166; stroke-width: 2.2; fill: none; }
    </style>
  </defs>

  <rect width="1600" height="900" rx="28" fill="url(#bg)" />
  <rect width="1600" height="900" rx="28" fill="url(#dotGrid)" opacity="0.6" />
  <circle cx="280" cy="160" r="260" fill="url(#glowTeal)" />
  <circle cx="1240" cy="620" r="300" fill="url(#glowOrange)" />

  <text x="60" y="42" fill="#f2eee5" font-size="20" font-weight="600">py-phone-caller system map</text>
  <text x="60" y="66" fill="#93a2b7" font-size="12">Event-driven emergency alerting with voice, SMS, and microservice orchestration</text>

  <rect x="60" y="90" width="320" height="360" rx="22" class="group-box" />
  <text x="82" y="120" class="group-label">TRIGGERS &amp; INTERFACES</text>

  <rect x="420" y="90" width="780" height="640" rx="24" class="group-box" />
  <text x="444" y="120" class="group-label">CORE MICROSERVICES</text>

  <rect x="1240" y="90" width="300" height="640" rx="22" class="group-box" />
  <text x="1262" y="120" class="group-label">EXTERNAL SYSTEMS</text>

  <rect x="420" y="750" width="780" height="120" rx="22" class="group-box" />
  <text x="444" y="780" class="group-label">DATA STORES</text>

  <g>
    <path d="M350 174 C380 174 410 172 450 172" class="flow" marker-end="url(#arrowTeal)" />
    <path d="M350 264 L420 264 L420 172 L700 172" class="flow" marker-end="url(#arrowTeal)" />
    <path d="M350 354 L400 354 L400 172 L450 172" class="flow" marker-end="url(#arrowTeal)" />

    <path d="M560 204 L560 250" class="flow" marker-end="url(#arrowTeal)" />
    <path d="M670 172 C690 172 690 282 700 282" class="flow" marker-end="url(#arrowTeal)" />

    <path d="M920 172 L950 172" class="flow" marker-end="url(#arrowTeal)" />
    <path d="M1060 204 C1060 228 900 228 810 250" class="flow" marker-end="url(#arrowTeal)" />

    <path d="M810 314 L810 360" class="flow" marker-end="url(#arrowTeal)" />
    <path d="M920 282 L935 282 L935 470 L920 470" class="flow" marker-end="url(#arrowTeal)" />

    <path d="M1060 314 L1060 360" class="flow" marker-end="url(#arrowTeal)" />
    <path d="M950 282 C920 282 900 360 920 392" class="flow" marker-end="url(#arrowTeal)" />

    <path d="M560 314 L560 360" class="flow" marker-end="url(#arrowTeal)" />
    <path d="M560 424 C610 424 660 392 700 392" class="flow" marker-end="url(#arrowTeal)" />
    <path d="M560 424 C610 424 650 282 700 282" class="flow" marker-end="url(#arrowTeal)" />

    <path d="M1170 392 C1210 392 1240 472 1270 472" class="flow" marker-end="url(#arrowTeal)" />
    <path d="M670 282 L690 282 L690 530 L1270 530" class="flow-yellow" marker-end="url(#arrowYellow)" />

    <path d="M920 282 C1050 282 1160 172 1270 172" class="flow-orange" marker-end="url(#arrowOrange)" />
    <path d="M1270 204 L1270 230" class="flow-orange" marker-end="url(#arrowOrange)" />
    <path d="M1270 294 L1270 320" class="flow-orange" marker-end="url(#arrowOrange)" />
    <path d="M1510 352 L1530 352 L1530 562 L1510 562" class="flow-yellow" marker-end="url(#arrowYellow)" />

    <path d="M1270 172 C1210 172 1140 262 1170 282" class="flow" marker-end="url(#arrowTeal)" />

    <path d="M700 392 L670 392 L670 790 L760 790" class="flow-blue" marker-end="url(#arrowBlue)" />
    <path d="M920 502 L940 502 L940 790 L860 790" class="flow-blue" marker-end="url(#arrowBlue)" />
    <path d="M1060 204 L1195 204 L1195 790 L1060 790" class="flow-blue" marker-end="url(#arrowBlue)" />
    <path d="M810 204 L935 204 L935 760 L1000 760 L1000 790" class="flow-blue" marker-end="url(#arrowBlue)" />
  </g>

  <g>
    <rect x="90" y="140" width="260" height="68" rx="16" class="node" />
    <rect x="90" y="140" width="260" height="34" rx="16" class="node-top" />
    <circle cx="115" cy="174" r="12" fill="#5cd6c7" />
    <text x="115" y="178" text-anchor="middle" fill="#0b2a27" font-size="10" font-weight="700">P</text>
    <text x="138" y="170" class="node-title">PROMETHEUS ALERTMANAGER</text>
    <text x="138" y="188" class="node-sub">Alert webhook triggers</text>
  </g>

  <g>
    <rect x="90" y="230" width="260" height="68" rx="16" class="node" />
    <rect x="90" y="230" width="260" height="34" rx="16" class="node-top" />
    <circle cx="115" cy="264" r="12" fill="#ff6f3c" />
    <text x="115" y="268" text-anchor="middle" fill="#2b1208" font-size="10" font-weight="700">UI</text>
    <text x="138" y="260" class="node-title">PY_PHONE_CALLER_UI</text>
    <text x="138" y="278" class="node-sub">Dashboard + operators</text>
  </g>

  <g>
    <rect x="90" y="320" width="260" height="68" rx="16" class="node" />
    <rect x="90" y="320" width="260" height="34" rx="16" class="node-top" />
    <circle cx="115" cy="354" r="12" fill="#75c8ff" />
    <text x="115" y="358" text-anchor="middle" fill="#102536" font-size="10" font-weight="700">API</text>
    <text x="138" y="350" class="node-title">HTTP CLIENT</text>
    <text x="138" y="368" class="node-sub">Manual trigger + API calls</text>
  </g>

  <g>
    <rect x="450" y="140" width="220" height="64" rx="16" class="node" />
    <rect x="450" y="140" width="220" height="30" rx="16" class="node-top" />
    <circle cx="472" cy="172" r="11" fill="#5cd6c7" />
    <text x="472" y="176" text-anchor="middle" fill="#0b2a27" font-size="9" font-weight="700">W</text>
    <text x="494" y="168" class="node-title">caller_prometheus_webhook</text>
    <text x="494" y="186" class="node-sub">Alertmanager ingest</text>
  </g>

  <g>
    <rect x="700" y="140" width="220" height="64" rx="16" class="node" />
    <rect x="700" y="140" width="220" height="30" rx="16" class="node-top" />
    <circle cx="722" cy="172" r="11" fill="#ffd166" />
    <text x="722" y="176" text-anchor="middle" fill="#3b2f0a" font-size="9" font-weight="700">S</text>
    <text x="744" y="168" class="node-title">caller_scheduler</text>
    <text x="744" y="186" class="node-sub">Scheduled alert intake</text>
  </g>

  <g>
    <rect x="950" y="140" width="220" height="64" rx="16" class="node" />
    <rect x="950" y="140" width="220" height="30" rx="16" class="node-top" />
    <circle cx="972" cy="172" r="11" fill="#75c8ff" />
    <text x="972" y="176" text-anchor="middle" fill="#102536" font-size="9" font-weight="700">CW</text>
    <text x="994" y="168" class="node-title">celery_worker</text>
    <text x="994" y="186" class="node-sub">Background call execution</text>
  </g>

  <g>
    <rect x="450" y="250" width="220" height="64" rx="16" class="node" />
    <rect x="450" y="250" width="220" height="30" rx="16" class="node-top" />
    <circle cx="472" cy="282" r="11" fill="#ff6f3c" />
    <text x="472" y="286" text-anchor="middle" fill="#2b1208" font-size="9" font-weight="700">SMS</text>
    <text x="494" y="278" class="node-title">caller_sms</text>
    <text x="494" y="296" class="node-sub">Twilio + USB modem</text>
  </g>

  <g>
    <rect x="700" y="250" width="220" height="64" rx="16" class="node" />
    <rect x="700" y="250" width="220" height="30" rx="16" class="node-top" />
    <circle cx="722" cy="282" r="11" fill="#ff6f3c" />
    <text x="722" y="286" text-anchor="middle" fill="#2b1208" font-size="9" font-weight="700">A</text>
    <text x="744" y="278" class="node-title">asterisk_caller</text>
    <text x="744" y="296" class="node-sub">Outbound call control</text>
  </g>

  <g>
    <rect x="950" y="250" width="220" height="64" rx="16" class="node" />
    <rect x="950" y="250" width="220" height="30" rx="16" class="node-top" />
    <circle cx="972" cy="282" r="11" fill="#75c8ff" />
    <text x="972" y="286" text-anchor="middle" fill="#102536" font-size="9" font-weight="700">WS</text>
    <text x="994" y="278" class="node-title">asterisk_ws_monitor</text>
    <text x="994" y="296" class="node-sub">Call lifecycle events</text>
  </g>

  <g>
    <rect x="450" y="360" width="220" height="64" rx="16" class="node" />
    <rect x="450" y="360" width="220" height="30" rx="16" class="node-top" />
    <circle cx="472" cy="392" r="11" fill="#ff6f3c" />
    <text x="472" y="396" text-anchor="middle" fill="#2b1208" font-size="9" font-weight="700">R</text>
    <text x="494" y="388" class="node-title">asterisk_recaller</text>
    <text x="494" y="406" class="node-sub">Retry + escalation</text>
  </g>

  <g>
    <rect x="700" y="360" width="220" height="64" rx="16" class="node" />
    <rect x="700" y="360" width="220" height="30" rx="16" class="node-top" />
    <circle cx="722" cy="392" r="11" fill="#8adf6c" />
    <text x="722" y="396" text-anchor="middle" fill="#18340f" font-size="9" font-weight="700">CR</text>
    <text x="744" y="388" class="node-title">caller_register</text>
    <text x="744" y="406" class="node-sub">Call state + history</text>
  </g>

  <g>
    <rect x="950" y="360" width="220" height="64" rx="16" class="node" />
    <rect x="950" y="360" width="220" height="30" rx="16" class="node-top" />
    <circle cx="972" cy="392" r="11" fill="#5cd6c7" />
    <text x="972" y="396" text-anchor="middle" fill="#0b2a27" font-size="9" font-weight="700">TTS</text>
    <text x="994" y="388" class="node-title">generate_audio</text>
    <text x="994" y="406" class="node-sub">Multi-engine voice</text>
  </g>

  <g>
    <rect x="700" y="470" width="220" height="64" rx="16" class="node" />
    <rect x="700" y="470" width="220" height="30" rx="16" class="node-top" />
    <circle cx="722" cy="502" r="11" fill="#8adf6c" />
    <text x="722" y="506" text-anchor="middle" fill="#18340f" font-size="9" font-weight="700">AB</text>
    <text x="744" y="498" class="node-title">caller_address_book</text>
    <text x="744" y="516" class="node-sub">Contacts + on-call</text>
  </g>

  <g>
    <rect x="450" y="590" width="720" height="58" rx="16" fill="#0f1a2a" stroke="#2a3d55" stroke-width="1" stroke-dasharray="6 6" />
    <text x="470" y="624" fill="#ffd166" font-size="11" font-weight="600">py-phone-caller-utils</text>
    <text x="640" y="624" fill="#a7b1c4" font-size="10">Dynaconf config, Piccolo ORM, telemetry, shared helpers</text>
  </g>

  <g>
    <rect x="1270" y="140" width="240" height="64" rx="16" class="node" />
    <rect x="1270" y="140" width="240" height="30" rx="16" class="node-top" />
    <circle cx="1292" cy="172" r="11" fill="#ff6f3c" />
    <text x="1292" y="176" text-anchor="middle" fill="#2b1208" font-size="9" font-weight="700">PBX</text>
    <text x="1314" y="168" class="node-title">ASTERISK PBX</text>
    <text x="1314" y="186" class="node-sub">ARI + RTP bridge</text>
  </g>

  <g>
    <rect x="1270" y="230" width="240" height="64" rx="16" class="node" />
    <rect x="1270" y="230" width="240" height="30" rx="16" class="node-top" />
    <circle cx="1292" cy="262" r="11" fill="#75c8ff" />
    <text x="1292" y="266" text-anchor="middle" fill="#102536" font-size="9" font-weight="700">SIP</text>
    <text x="1314" y="258" class="node-title">SIP SERVICE PROVIDER</text>
    <text x="1314" y="276" class="node-sub">Carrier trunk</text>
  </g>

  <g>
    <rect x="1270" y="320" width="240" height="64" rx="16" class="node" />
    <rect x="1270" y="320" width="240" height="30" rx="16" class="node-top" />
    <circle cx="1292" cy="352" r="11" fill="#ffd166" />
    <text x="1292" y="356" text-anchor="middle" fill="#3b2f0a" font-size="9" font-weight="700">REC</text>
    <text x="1314" y="348" class="node-title">CALLEE / SMS RECEIVER</text>
    <text x="1314" y="366" class="node-sub">Landline, mobile, or SMS</text>
  </g>

  <g>
    <rect x="1270" y="440" width="240" height="64" rx="16" class="node" />
    <rect x="1270" y="440" width="240" height="30" rx="16" class="node-top" />
    <circle cx="1292" cy="472" r="11" fill="#5cd6c7" />
    <text x="1292" y="476" text-anchor="middle" fill="#0b2a27" font-size="9" font-weight="700">TTS</text>
    <text x="1314" y="468" class="node-title">TTS ENGINES</text>
    <text x="1314" y="486" class="node-sub">gTTS, Polly, Piper, MMS, Kokoro</text>
  </g>

  <g>
    <rect x="1270" y="530" width="240" height="64" rx="16" class="node" />
    <rect x="1270" y="530" width="240" height="30" rx="16" class="node-top" />
    <circle cx="1292" cy="562" r="11" fill="#ff6f3c" />
    <text x="1292" y="566" text-anchor="middle" fill="#2b1208" font-size="9" font-weight="700">SMS</text>
    <text x="1314" y="558" class="node-title">SMS PROVIDERS</text>
    <text x="1314" y="576" class="node-sub">Twilio or USB modem</text>
  </g>

  <g>
    <rect x="680" y="790" width="260" height="64" rx="16" class="node" />
    <rect x="680" y="790" width="260" height="30" rx="16" class="node-top" />
    <circle cx="702" cy="822" r="11" fill="#75c8ff" />
    <text x="702" y="826" text-anchor="middle" fill="#102536" font-size="9" font-weight="700">DB</text>
    <text x="724" y="818" class="node-title">POSTGRESQL</text>
    <text x="724" y="836" class="node-sub">Call + contact data</text>
  </g>

  <g>
    <rect x="930" y="790" width="260" height="64" rx="16" class="node" />
    <rect x="930" y="790" width="260" height="30" rx="16" class="node-top" />
    <circle cx="952" cy="822" r="11" fill="#ffd166" />
    <text x="952" y="826" text-anchor="middle" fill="#3b2f0a" font-size="9" font-weight="700">R</text>
    <text x="974" y="818" class="node-title">REDIS</text>
    <text x="974" y="836" class="node-sub">Celery queues + schedules</text>
  </g>
</svg>
